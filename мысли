1) У меня будет сопоставление session_id и user_id в бд. Redis
2) Мне приходит запрос с куками session_id, я восстанавливаю user_id и записываю все файлы в подходящую папку - user:user_id.
3) Перед записью, я создаю в БД message, который имеет: путь, название файла, тип файла, время записи.
4) Если человек разорвал сессию, важно проследить, чтоб не создавалась новая папка.

